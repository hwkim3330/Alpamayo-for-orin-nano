# ROS2 Web Dashboard Configuration
# Optimized for Jetson Orin Nano

# ============================================
# Rosbridge WebSocket Server
# ============================================
rosbridge_websocket:
  ros__parameters:
    port: 9090
    address: "0.0.0.0"
    retry_startup_delay: 5.0
    fragment_timeout: 600
    delay_between_messages: 0
    max_message_size: 10000000
    unregister_timeout: 10.0
    use_compression: false

# ============================================
# Web Video Server
# ============================================
web_video_server:
  ros__parameters:
    port: 8080
    address: "0.0.0.0"
    server_threads: 2
    ros_threads: 4
    default_stream_type: "mjpeg"
    quality: 70

# ============================================
# LiDAR BEV Node
# ============================================
lidar_bev_node:
  ros__parameters:
    # Input/Output topics
    input_topic: "/scan"
    output_topic: "/lidar/bev_image"

    # Grid configuration
    x_range: [-5.0, 15.0]    # Behind to front (meters)
    y_range: [-10.0, 10.0]   # Left to right (meters)
    resolution: 0.1          # Meters per pixel

    # Temporal settings
    decay_factor: 0.9        # How fast old points fade (0-1)

    # LiDAR type
    use_pointcloud2: false   # true for 3D LiDAR

# ============================================
# Camera Stream Node
# ============================================
camera_stream_node:
  ros__parameters:
    # Topics
    input_topic: "/camera/image_raw"
    output_topic: "/camera/image_web"
    compressed_topic: "/camera/image_compressed"

    # Resolution (adjust for Jetson performance)
    target_width: 640
    target_height: 360

    # Compression
    jpeg_quality: 70         # 0-100, lower = smaller/faster

    # Frame rate
    target_fps: 15.0

    # Overlay
    draw_info: true

# ============================================
# Vehicle State Node
# ============================================
vehicle_state_node:
  ros__parameters:
    publish_rate: 10.0
    state_topic: "/vehicle/state_json"

# ============================================
# Planner Visualization Node
# ============================================
planner_viz_node:
  ros__parameters:
    path_topic: "/planner/path"
    markers_topic: "/planner/markers"
    detections_topic: "/planner/detections_json"
    publish_rate: 10.0

# ============================================
# Jetson Orin Nano Specific Settings
# ============================================
# For lower-power modes, reduce these values:
#
# jetson_orin_mode_15w:
#   camera_stream_node:
#     target_width: 480
#     target_height: 270
#     jpeg_quality: 50
#     target_fps: 10.0
#
#   lidar_bev_node:
#     resolution: 0.15
#     decay_factor: 0.8
#
# jetson_orin_mode_maxn:
#   camera_stream_node:
#     target_width: 1280
#     target_height: 720
#     jpeg_quality: 80
#     target_fps: 30.0
